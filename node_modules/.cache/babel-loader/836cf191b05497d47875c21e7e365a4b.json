{"remainingRequest":"C:\\Users\\ASUS\\Desktop\\源码\\19. 受保护的页面\\news-app\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\ASUS\\Desktop\\源码\\19. 受保护的页面\\news-app\\src\\services\\userService.js","dependencies":[{"path":"C:\\Users\\ASUS\\Desktop\\源码\\19. 受保护的页面\\news-app\\src\\services\\userService.js","mtime":1589952235000},{"path":"C:\\Users\\ASUS\\Desktop\\源码\\19. 受保护的页面\\news-app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ASUS\\Desktop\\源码\\19. 受保护的页面\\news-app\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6L1VzZXJzL0FTVVMvRGVza3RvcC9cdTZFOTBcdTc4MDEvMTkuIFx1NTNEN1x1NEZERFx1NjJBNFx1NzY4NFx1OTg3NVx1OTc2Mi9uZXdzLWFwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CgpmdW5jdGlvbiBkZWxheShkdXJhdGlvbikgewogIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgIHJlc29sdmUoKTsKICAgIH0sIGR1cmF0aW9uKTsKICB9KTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGxvZ2luKF94KSB7CiAgcmV0dXJuIF9sb2dpbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9IC8vIOS9v+eUqOS/neWtmOeahOS7pOeJjOS7juacjeWKoeWZqOaNouWPlueZu+W9leS/oeaBrwoKZnVuY3Rpb24gX2xvZ2luKCkgewogIF9sb2dpbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShsb2dpbkluZm8pIHsKICAgIHZhciByZXNwLCB0b2tlbjsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBkZWxheSgyMDAwKTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICByZXR1cm4gYXhpb3MucG9zdCgiL2FwaS91c2VyL2xvZ2luIiwgbG9naW5JbmZvKTsKCiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIHJlc3AgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICB0b2tlbiA9IHJlc3AuaGVhZGVycy5hdXRob3JpemF0aW9uOyAvLyDmi7/liLDmnI3liqHlmajnmoTku6TniYwKCiAgICAgICAgICAgIGlmICh0b2tlbikgewogICAgICAgICAgICAgIC8vIOaKiuS7pOeJjOS/neWtmOS4i+adpQogICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJ0b2tlbiIsIHRva2VuKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgcmVzcC5kYXRhKTsKCiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSk7CiAgfSkpOwogIHJldHVybiBfbG9naW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIHdob0FtSSgpIHsKICByZXR1cm4gX3dob0FtSS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9IC8vIOazqOmUgAoKZnVuY3Rpb24gX3dob0FtSSgpIHsKICBfd2hvQW1JID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgIHZhciB0b2tlbiwgcmVzcDsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIGRlbGF5KDIwMDApOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKTsKCiAgICAgICAgICAgIGlmICh0b2tlbikgewogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIG51bGwpOwoKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA3OwogICAgICAgICAgICByZXR1cm4gYXhpb3MuZ2V0KCIvYXBpL3VzZXIvd2hvYW1pIiwgewogICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgIGF1dGhvcml6YXRpb246ICJiZWFyZXIgIi5jb25jYXQodG9rZW4pCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIHJlc3AgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIHJlc3AuZGF0YS5kYXRhKTsKCiAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUyKTsKICB9KSk7CiAgcmV0dXJuIF93aG9BbUkuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGxvZ2luT3V0KCkgewogIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJ0b2tlbiIpOwp9IC8vIOazqOWGjAoKZXhwb3J0IGZ1bmN0aW9uIHJlZyhfeDIpIHsKICByZXR1cm4gX3JlZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfcmVnKCkgewogIF9yZWcgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKHVzZXJJbmZvKSB7CiAgICB2YXIgcmVzcDsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIGF4aW9zLnBvc3QoIi9hcGkvdXNlci9yZWciLCB1c2VySW5mbyk7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICByZXNwID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCByZXNwLmRhdGEpOwoKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZTMpOwogIH0pKTsKICByZXR1cm4gX3JlZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9"},{"version":3,"sources":["C:/Users/ASUS/Desktop/源码/19. 受保护的页面/news-app/src/services/userService.js"],"names":["axios","delay","duration","Promise","resolve","setTimeout","login","loginInfo","post","resp","token","headers","authorization","localStorage","setItem","data","whoAmI","getItem","get","loginOut","removeItem","reg","userInfo"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;;AAEA,SAASC,KAAT,CAAeC,QAAf,EAAyB;AACvB,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAa;AAC9BC,IAAAA,UAAU,CAAC,YAAM;AACfD,MAAAA,OAAO;AACR,KAFS,EAEPF,QAFO,CAAV;AAGD,GAJM,CAAP;AAKD;;AAED,gBAAsBI,KAAtB;AAAA;AAAA,C,CAYA;;;mEAZO,iBAAqBC,SAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACCN,KAAK,CAAC,IAAD,CADN;;AAAA;AAAA;AAAA,mBAGYD,KAAK,CAACQ,IAAN,CAAW,iBAAX,EAA8BD,SAA9B,CAHZ;;AAAA;AAGDE,YAAAA,IAHC;AAIDC,YAAAA,KAJC,GAIOD,IAAI,CAACE,OAAL,CAAaC,aAJpB,EAImC;;AACxC,gBAAIF,KAAJ,EAAW;AACT;AACAG,cAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BJ,KAA9B;AACD;;AARI,6CASED,IAAI,CAACM,IATP;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AAaP,gBAAsBC,MAAtB;AAAA;AAAA,C,CAgBA;;;oEAhBO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAGCf,KAAK,CAAC,IAAD,CAHN;;AAAA;AAIDS,YAAAA,KAJC,GAIOG,YAAY,CAACI,OAAb,CAAqB,OAArB,CAJP;;AAAA,gBAKAP,KALA;AAAA;AAAA;AAAA;;AAAA,8CAMI,IANJ;;AAAA;AAAA;AAAA,mBAQYV,KAAK,CAACkB,GAAN,CAAU,kBAAV,EAA8B;AAC7CP,cAAAA,OAAO,EAAE;AACPC,gBAAAA,aAAa,mBAAYF,KAAZ;AADN;AADoC,aAA9B,CARZ;;AAAA;AAQDD,YAAAA,IARC;AAAA,8CAaEA,IAAI,CAACM,IAAL,CAAUA,IAbZ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AAiBP,OAAO,SAASI,QAAT,GAAoB;AACzBN,EAAAA,YAAY,CAACO,UAAb,CAAwB,OAAxB;AACD,C,CAED;;AACA,gBAAsBC,GAAtB;AAAA;AAAA;;;iEAAO,kBAAmBC,QAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEYtB,KAAK,CAACQ,IAAN,CAAW,eAAX,EAA4Bc,QAA5B,CAFZ;;AAAA;AAEDb,YAAAA,IAFC;AAAA,8CAGEA,IAAI,CAACM,IAHP;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["import axios from \"axios\";\n\nfunction delay(duration) {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve();\n    }, duration);\n  });\n}\n\nexport async function login(loginInfo) {\n  await delay(2000);\n  // post http://study.yuanjin.tech/api/user/login\n  var resp = await axios.post(\"/api/user/login\", loginInfo);\n  var token = resp.headers.authorization; // 拿到服务器的令牌\n  if (token) {\n    // 把令牌保存下来\n    localStorage.setItem(\"token\", token);\n  }\n  return resp.data;\n}\n\n// 使用保存的令牌从服务器换取登录信息\nexport async function whoAmI() {\n  // get http://study.yuanjin.tech/api/user/whoami\n  // authorization: bearer tokenxxxxx\n  await delay(2000);\n  var token = localStorage.getItem(\"token\");\n  if (!token) {\n    return null;\n  }\n  var resp = await axios.get(\"/api/user/whoami\", {\n    headers: {\n      authorization: `bearer ${token}`,\n    },\n  });\n  return resp.data.data;\n}\n\n// 注销\nexport function loginOut() {\n  localStorage.removeItem(\"token\");\n}\n\n// 注册\nexport async function reg(userInfo) {\n  // post http://study.yuanjin.tech/api/user/reg\n  var resp = await axios.post(\"/api/user/reg\", userInfo);\n  return resp.data;\n}\n"]}]}